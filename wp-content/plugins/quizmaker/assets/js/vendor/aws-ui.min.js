AWS_UI_Message=function(){var t;return{inform:function(e){if("undefined"==typeof e.content||""==e.content)return!1;var n=this,i=jQuery('<div class="aws-ui-message"></div>');e=_.extend({type:"info",is_auto_hide:!0,duration:4e3},e),jQuery("body").append(i),i.addClass(e.type).addClass("show").html(e.content),this.element=i,i.click(function(t){t.preventDefault(),n.hide()}),e.is_auto_hide&&(t=setTimeout(function(){n.hide()},e.duration))},hide:function(){var e=this;clearTimeout(t),this.element.removeClass("show"),setTimeout(function(){e.element.remove()},500)}}},AWS_UI_Ajax_Button=function(t){return{init:function(){this.events()},events:function(){var e=this;t.find(".wte-ajax").each(function(){var t=jQuery(this);jQuery(this).click(function(n){n.preventDefault(),e.action(t)})})},action:function(e){var n=AWS_UI_Message();n.loading(),jQuery.post(wootrigger.ajax_url,{action:e.data("action"),security:e.data("security"),data:e.data("params")},function(i){"undefined"!=typeof i.status&&n.show(i.message,{type:i.status}),"undefined"!=typeof e.data("triggers")&&jQuery.each(e.data("triggers"),function(e,n){t.trigger(n)})})},refresh:function(){this.events()}}},AWS_UI_Dialog=function(t,e){e=_.extend({width:400,height:300,title:"Dialog"},e);var n,i=jQuery("body"),a=jQuery('<div class="aws-ui-dialog"><div class="overlay"></div><div class="aws-ui-dialog_content"><div class="aws-ui-dialog_content_title">'+e.title+'</div><button class="aws-ui-dialog_close"></button><div class="aws-ui-dialog_content_body"></div><div class="aws-ui-dialog_content_action"><div class="pull-right"><button class="button btn-cancel">Cancel</button><button class="button button-primary btn-ok">OK</button></div></div></div></div>'),o=a.find(".aws-ui-dialog_close"),s=a.find(".aws-ui-dialog_content"),c=a.find(".aws-ui-dialog_content_body"),d=a.find(".overlay"),u=a.find(".btn-ok"),r=a.find(".btn-cancel"),l={init:function(){this.events()},show:function(){this.setPosition(),s.find(".aws-ui-dialog_content_body").html(t),i.append(a)},close:function(){a.remove()},events:function(){var i=this;jQuery(window).resize(function(){i.setPosition()}),d.click(function(){i.close()}),o.click(function(){i.close()}),r.click(function(){i.close()}),u.click(function(e){t.trigger("aws-ui-dialog-event-ok",n),i.close(),e.preventDefault()}),e.show_scroll&&this.show_scroll()},setPosition:function(){var t=jQuery(window).width(),n=jQuery(window).height(),i=e.width,a=e.height,o=10,d=0;t<i&&(i=t-10),n<a&&(a=n-70),d=(t-i)/2,o=(n-a)/2,s.css({width:i,height:a,top:o,left:d}),c.css({height:a-41-48})},setData:function(t){n=t},show_scroll:function(){s.find(".aws-ui-dialog_content_body").addClass("scroll")}};return l.init(),l},AWS_UI_Dropdown=function(t,e){var n=t.find(".aws-ui-dropdown");return{init:function(){this.events()},events:function(){var t=this;n.click(function(e){t.action(jQuery(this))}),n.find("button").click(function(t){t.preventDefault()}),jQuery(document).click(function(t){jQuery(t.target).closest(n).length||n.hasClass("open")&&n.removeClass("open")})},action:function(t){n.not(t).removeClass("open"),t.hasClass("open")?t.removeClass("open"):t.addClass("open")},refresh:function(){n=t.find(".aws-ui-dropdown"),this.events()}}},AWS_UI_Toogle=function(t,e){return{init:function(){var e=this;this.events(),t.find(".aws-ui-switch").each(function(){e.action_switch(jQuery(this),jQuery(this).find("input[type=checkbox]").is(":checked"))})},events:function(){var e=this;t.find(".aws-ui-switch").click(function(t){e.action(jQuery(this))})},action:function(t){var e=t.find("input[type=checkbox]"),n=0;e.is(":checked")?(n=0,e.prop("checked",!1),this.action_switch(t,!1)):(n=1,e.prop("checked",!0),this.action_switch(t,!0)),t.trigger("aws-ui-switch",n)},action_switch:function(t,e){e?(t.removeClass("aws-ui-switch__off"),t.addClass("aws-ui-switch__on")):(t.removeClass("aws-ui-switch__on"),t.addClass("aws-ui-switch__off"))},refresh:function(){this.events()}}},AWS_Table_Data=function(t,e){var e=jQuery.extend({delay:0},e),n=t.data("ajax-action"),i=t.data("ajax-security"),a=t.data("ajax-url"),o=t.data("ajax-params"),s=t.find("tbody");return{page:1,init:function(){var n=this;this.ajax_buttons=new AWS_UI_Ajax_Button(t),this.dropdowns=new AWS_UI_Dropdown(t),this.toogles=new AWS_UI_Toogle(t),delay=1e3*e.delay,t.on("aws-table-data-no-data",function(t,e){n.hide_pagination(),n.clear_data()}),t.on("aws-table-data-loading-data",function(t,e){n.load_data(1)}),t.on("aws-table-data-refresh-data",function(){n.load_data(n.page)}),t.find("input.aws-ui-table-data-checkall").click(function(){jQuery(this).is(":checked")?t.find("input.select_row").prop("checked",!0):t.find("input.select_row").prop("checked",!1)}),setTimeout(function(){n.load_data(1)},delay)},post:function(t){return t=jQuery.extend(o,t),jQuery.post(a,{action:n,security:i,data:t})},set_content:function(e){"success"==e.status&&(s.html(e.html),this.page=e.pagination.page,this.load_pagination(e.pagination)),"undefined"!=typeof e.exclude&&t.data("exclude",e.exclude),t.trigger("aws-table-data-after-loading-data",e),this.ajax_buttons.refresh(),this.dropdowns.refresh(),this.toogles.refresh()},has_data:function(){return t.find("tbody tr").length},load_data:function(e){var n=this,i=jQuery.Deferred();return t.addClass("loading"),jQuery.when(this.post({page:e})).then(function(e){n.set_content(e),t.removeClass("loading"),i.resolve(e)}),i.promise()},action:function(e,n){var n=jQuery.extend({data:{is_refresh:1}},n),i=this,a=jQuery.Deferred();return t.addClass("loading"),jQuery.when(this.post({method:e,action_data:n.data})).then(function(e){n.is_refresh&&(s.empty(),i.set_content(e)),t.removeClass("loading"),"undefined"!=typeof e.message&&AWS_UI_Message().inform(e.message),t.find("input.aws-ui-table-data-checkall, input.select_row").prop("checked",!1),a.resolve(e)}),a.promise()},edit:function(t){jQuery.when(this.post({method:"edit"})).then(function(t){})},get_selected:function(){var t=[];return jQuery("input.select_row:checked").map(function(){t.push(jQuery(this).val())}),t},load_pagination:function(e){var n=this,i=t.find(".aws-ui-pagination"),a=i.find(".pages");if(0==i.length)return!1;if(a.empty(),i.css("opacity",1),0==e.total)return i.css("opacity",0),!1;for(var o=0;o<e.pages;o++){var s=o+1,c=jQuery('<a class="page" data-page="'+s+'">'+s+"</a>");o==e.page-1&&c.addClass("active"),c.click(function(e){e.preventDefault();var i=(jQuery.Deferred(),jQuery(this).data("page"));jQuery.when(n.load_data(i)).then(function(){t.data("page",i)})}),a.append(c)}i.find(".page-next").click(function(){i.find(".active").next(".page").trigger("click")}),i.find(".page-prev").click(function(){i.find(".active").prev(".page").trigger("click")})},hide_pagination:function(){var e=t.find(".aws-ui-pagination"),n=e.find(".pages");e.css("opacity",0),n.empty()},clear_data:function(){t.find("tbody tr").not(".nodata").remove()},refresh:function(){this.load_data(this.page)}}};