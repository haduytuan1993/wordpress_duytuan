jQuery(function(e){QM_Engine_Viral=function(n,t){t=e.extend({total:1,pages:1,is_form:"no",is_instant_answer:"no",is_show_answers:"yes"},t);var a=new QM_Engine_Questions(n,t);return{current_page:1,init:function(){a.init(),this._events(),this.page(1)},_events:function(){var i=this,s=n.find(".pagination .next"),r=n.find(".pagination .prev"),o=n.find(".qm-submit");if(a.on("change",function(){i.is_last_page()&&n.trigger("_qm_engine_last_page")}),o.click(function(e){e.preventDefault(),o.addClass("fadeOut"),o.animate({height:0},500),"yes"==t.is_form?n.find(".action-form").addClass("s"):i.load_html_result(a.get_result()).done(function(e){i.show_result(e.html,e.questions)})}),a.on("complete",function(e){o.addClass("bounceIn").addClass("animated")}),s.click(function(e){e.preventDefault(),s.removeClass("s"),i.next()}),r.click(function(e){e.preventDefault(),r.removeClass("s"),i.prev()}),n.on("quizmaker-page-change",function(e,t){n.find(".pagination li").removeClass("active"),n.find(".pagination li").eq(t-1).addClass("active")}),n.find(".pagination a").click(function(n){n.preventDefault(),i.page(e(this).data("page")),i.current_page=parseInt(e(this).data("page"))}),n.on("_qm_engine_last_page",function(){i.is_last_pages()?s.removeClass("s"):s.addClass("s"),i.current_page>1?r.addClass("s"):r.removeClass("s")}),"yes"==t.is_form){n.find(".wpcf7").on("wpcf7:mailsent",function(){i.load_html_result(a.get_result()).done(function(e){setTimeout(function(){n.find(".action-form").removeClass("s"),i.show_result(e.html,e.questions)},2e3)})})}},load_html_result:function(n){return e.post(qmviral.ajax_url,{action:"quizmaker_load_html_result",security:t.result_nonce,data:n})},show_result:function(e,i){n.find(".results").html(e),"yes"==t.is_show_answers?a.show_anwers(i):a.disable()},finish:function(){},page:function(t){var i=this,s=n.find(".page");s.each(function(){e(this).data("page")==t&&(e(this).hasClass("loaded")||(e(this).children(".question").each(function(){a.add_question(e(this))}),e(this).addClass("loaded")),s.removeClass("active"),e(this).addClass("active"),i.current_page=t)}),n.trigger("quizmaker-page-change",t)},is_last_page:function(){var t=this,a=n.find(".page").filter(function(){return e(this).data("page")==t.current_page});return a.find(".s-1").length==a.find(".question").length},is_last_pages:function(){return!(this.current_page<t.pages)},pagination:function(){},next:function(){this.is_last_pages()||(this.current_page++,this.page(this.current_page),n.trigger("_qm_engine_last_pages"))},prev:function(){this.current_page>1&&(this.current_page--,this.page(this.current_page),n.trigger("_qm_engine_last_pages"))}}},e(document).ready(function(){e(".quizmaker-viral").each(function(){new QM_Engine_Viral(e(this),e(this).data("params")).init()})})});