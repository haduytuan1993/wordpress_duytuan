AWS_UI_Message=function(){var t;return{inform:function(e){if(void 0===e.content||""==e.content)return!1;var i=this,n=jQuery('<div class="aws-ui-message"></div>');e=_.extend({type:"info",is_auto_hide:!0,duration:4e3},e),jQuery("body").append(n),n.addClass(e.type).addClass("show").html(e.content),this.element=n,n.click(function(t){t.preventDefault(),i.hide()}),e.is_auto_hide&&(t=setTimeout(function(){i.hide()},e.duration))},hide:function(){var e=this;clearTimeout(t),this.element.removeClass("show"),setTimeout(function(){e.element.remove()},500)}}},AWS_UI_Ajax_Button=function(t){return{init:function(){this.events()},events:function(){var e=this;t.find(".wte-ajax").each(function(){var t=jQuery(this);jQuery(this).click(function(i){i.preventDefault(),e.action(t)})})},action:function(e){var i=AWS_UI_Message();i.loading(),jQuery.post(wootrigger.ajax_url,{action:e.data("action"),security:e.data("security"),data:e.data("params")},function(n){void 0!==n.status&&i.show(n.message,{type:n.status}),void 0!==e.data("triggers")&&jQuery.each(e.data("triggers"),function(e,i){t.trigger(i)})})},refresh:function(){this.events()}}},AWS_UI_Dialog=function(t,e){e=_.extend({width:400,height:300,title:"Dialog"},e);var i,n=jQuery("body"),a=jQuery('<div class="aws-ui-dialog"><div class="overlay"></div><div class="aws-ui-dialog_content"><div class="aws-ui-dialog_content_title">'+e.title+'</div><button class="aws-ui-dialog_close"></button><div class="aws-ui-dialog_content_body"></div><div class="aws-ui-dialog_content_action"><div class="pull-right"><button class="button btn-cancel">Cancel</button><button class="button button-primary btn-ok">OK</button></div></div></div></div>'),o=a.find(".aws-ui-dialog_close"),s=a.find(".aws-ui-dialog_content"),c=a.find(".aws-ui-dialog_content_body"),d=a.find(".overlay"),r=a.find(".btn-ok"),u=a.find(".btn-cancel"),l={init:function(){this.events()},show:function(){this.setPosition(),s.find(".aws-ui-dialog_content_body").html(t),n.append(a)},close:function(){a.remove()},events:function(){var n=this;jQuery(window).resize(function(){n.setPosition()}),d.click(function(){n.close()}),o.click(function(){n.close()}),u.click(function(){n.close()}),r.click(function(e){t.trigger("aws-ui-dialog-event-ok",i),n.close(),e.preventDefault()}),e.show_scroll&&this.show_scroll()},setPosition:function(){var t=jQuery(window).width(),i=jQuery(window).height(),n=e.width,a=e.height,o=10,d=0;t<n&&(n=t-10),i<a&&(a=i-70),d=(t-n)/2,o=(i-a)/2,s.css({width:n,height:a,top:o,left:d}),c.css({height:a-41-48})},setData:function(t){i=t},show_scroll:function(){s.find(".aws-ui-dialog_content_body").addClass("scroll")}};return l.init(),l},AWS_UI_Dropdown=function(t,e){var i=t.find(".aws-ui-dropdown");return{init:function(){this.events()},events:function(){var t=this;i.click(function(e){t.action(jQuery(this))}),i.find("button").click(function(t){t.preventDefault()}),jQuery(document).click(function(t){jQuery(t.target).closest(i).length||i.hasClass("open")&&i.removeClass("open")})},action:function(t){i.not(t).removeClass("open"),t.hasClass("open")?t.removeClass("open"):t.addClass("open")},refresh:function(){i=t.find(".aws-ui-dropdown"),this.events()}}},AWS_UI_Toogle=function(t,e){return{init:function(){var e=this;this.events(),t.find(".aws-ui-switch").each(function(){e.action_switch(jQuery(this),jQuery(this).find("input[type=checkbox]").is(":checked"))})},events:function(){var e=this;t.find(".aws-ui-switch").click(function(t){e.action(jQuery(this))})},action:function(t){var e=t.find("input[type=checkbox]"),i=0;e.is(":checked")?(i=0,e.prop("checked",!1),this.action_switch(t,!1)):(i=1,e.prop("checked",!0),this.action_switch(t,!0)),t.trigger("aws-ui-switch",i)},action_switch:function(t,e){e?(t.removeClass("aws-ui-switch__off"),t.addClass("aws-ui-switch__on")):(t.removeClass("aws-ui-switch__on"),t.addClass("aws-ui-switch__off"))},refresh:function(){this.events()}}},AWS_Table_Data=function(t,e){var e=jQuery.extend({delay:0},e),i=t.data("ajax-action"),n=t.data("ajax-security"),a=t.data("ajax-url"),o=t.data("ajax-params"),s=t.find("tbody");return{page:1,init:function(){var i=this;this.ajax_buttons=new AWS_UI_Ajax_Button(t),this.dropdowns=new AWS_UI_Dropdown(t),this.toogles=new AWS_UI_Toogle(t),delay=1e3*e.delay,t.on("aws-table-data-no-data",function(t,e){i.hide_pagination(),i.clear_data()}),t.on("aws-table-data-loading-data",function(t,e){i.load_data(1)}),t.on("aws-table-data-refresh-data",function(){i.load_data(i.page)}),t.find("input.aws-ui-table-data-checkall").click(function(){jQuery(this).is(":checked")?t.find("input.select_row").prop("checked",!0):t.find("input.select_row").prop("checked",!1)}),setTimeout(function(){i.load_data(1)},delay)},post:function(t){return t=jQuery.extend(o,t),jQuery.post(a,{action:i,security:n,data:t})},set_content:function(e){"success"==e.status&&(s.html(e.html),this.page=e.pagination.page,this.load_pagination(e.pagination)),void 0!==e.exclude&&t.data("exclude",e.exclude),t.trigger("aws-table-data-after-loading-data",e),this.ajax_buttons.refresh(),this.dropdowns.refresh(),this.toogles.refresh()},has_data:function(){return t.find("tbody tr").length},load_data:function(e){var i=this,n=jQuery.Deferred();return t.addClass("loading"),jQuery.when(this.post({page:e,method:!1})).then(function(e){i.set_content(e),t.removeClass("loading"),n.resolve(e)}),n.promise()},action:function(e,i){var i=jQuery.extend({data:{is_refresh:1}},i),n=this,a=jQuery.Deferred();return t.addClass("loading"),jQuery.when(this.post({method:e,action_data:i.data})).then(function(e){i.is_refresh&&(s.empty(),n.set_content(e)),t.removeClass("loading"),void 0!==e.message&&AWS_UI_Message().inform(e.message),t.find("input.aws-ui-table-data-checkall, input.select_row").prop("checked",!1),a.resolve(e)}),a.promise()},edit:function(t){jQuery.when(this.post({method:"edit"})).then(function(t){})},get_selected:function(){var t=[];return jQuery("input.select_row:checked").map(function(){t.push(jQuery(this).val())}),t},load_pagination:function(e){var i=this,n=t.find(".aws-ui-pagination"),a=n.find(".pages");if(0==n.length)return!1;if(a.empty(),n.css("opacity",1),0==e.total)return n.css("opacity",0),!1;for(var o=0;o<e.pages;o++){var s=o+1,c=jQuery('<a class="page" data-page="'+s+'">'+s+"</a>");o==e.page-1&&c.addClass("active"),c.click(function(e){e.preventDefault();var n=(jQuery.Deferred(),jQuery(this).data("page"));jQuery.when(i.load_data(n)).then(function(){t.data("page",n)})}),a.append(c)}n.find(".page-next").click(function(){n.find(".active").next(".page").trigger("click")}),n.find(".page-prev").click(function(){n.find(".active").prev(".page").trigger("click")})},hide_pagination:function(){var e=t.find(".aws-ui-pagination"),i=e.find(".pages");e.css("opacity",0),i.empty()},clear_data:function(){t.find("tbody tr").not(".nodata").remove()},refresh:function(){this.load_data(this.page)}}};